var G=Object.defineProperty,z=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var L=(o,e,i)=>e in o?G(o,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[e]=i,A=(o,e)=>{for(var i in e||(e={}))q.call(e,i)&&L(o,i,e[i]);if(B)for(var i of B(e))H.call(e,i)&&L(o,i,e[i]);return o},D=(o,e)=>z(o,M(e));import{ad as O,ao as W,ay as T,r as N,al as x,u as J,a as K,o as Q,ap as X,t as Y,c as u,d as E,e as Z,w as s,ak as h,f as t,g as S,an as V,az as w,h as m,ae as $,i as P,ah as oo,ai as eo,aj as lo}from"./vendor.a93cca51.js";import{W as to}from"./wangEditor.f9f41d2d.js";import{a as y}from"./axios.64f7e1f7.js";import{_ as ao,d as so,l as ro,u as no}from"./index.e972642b.js";const io={name:"AddGood",components:{Plus:O,Delete:W},setup(){T();const o=N(null),e=N(null),i=N(null),p=x(),j=J(),{id:f}=p.query,l=K({checkedNames:[1,2],disabled:!1,uploadImgServer:so,token:ro("token")||"",id:f,defaultCate:"\u8BF7\u9009\u62E9",goodForm:{goodsName:"",goodsIntro:"",originalPrice:"",sellingPrice:"",stockNum:"",goodsSellStatus:"0",goodsCoverImg:"",tag:"",fileList:[]},categoryId:"",category:{lazy:!0,lazyLoad(n,a){const{level:g,value:I}=n;y.get("/categories.php",{params:{categoryLevel:g+1,parentId:I||0}}).then(b=>{const F=b.list.map(R=>({value:R.categoryId,label:R.categoryName,leaf:g>=1}));a(F)})}}});let r;Q(()=>{r=new to(e.value),r.config.showLinkImg=!1,r.config.showLinkImgAlt=!1,r.config.showLinkImgHref=!1,r.config.uploadImgMaxSize=2*1024*1024,r.config.uploadFileName="file",r.config.uploadImgHeaders={token:l.token},r.config.uploadImgHooks={customInsert:function(n,a){console.log("result",a),a.data&&a.data.length&&a.data.forEach(g=>n(g))}},r.config.uploadImgServer=no,Object.assign(r.config,{onchange(){console.log("change")}}),r.create(),f&&y.get("/good_info.php",{params:{id:f}}).then(n=>{const{goods:a,firstCategory:g,secondCategory:I,thirdCategory:b}=n;l.goodForm={goodsName:a.goodsName,goodsIntro:a.goodsIntro,originalPrice:a.originalPrice,sellingPrice:a.sellingPrice,stockNum:a.stockNum,goodsSellStatus:String(a.goodsSellStatus),goodsCoverImg:a.goodsCoverImg,tag:a.tag,categoryId:a.goodsCategoryId,fileList:[{url:a.goodsCoverImg}]},l.categoryId=a.goodsCategoryId,r&&r.txt.html(a.goodsDetailContent)})}),X(()=>{r.destroy(),r=null});const c=()=>{i.value.validate(n=>{if(n){let a=y.post,g={goodsCategoryId:l.categoryId,goodsCoverImg:l.goodForm.goodsCoverImg,goodsDetailContent:r.txt.html(),goodsIntro:l.goodForm.goodsIntro,goodsName:l.goodForm.goodsName,goodsSellStatus:l.goodForm.goodsSellStatus,originalPrice:l.goodForm.originalPrice,sellingPrice:l.goodForm.sellingPrice,stockNum:l.goodForm.stockNum,tag:l.goodForm.tag};if(g.goodsName.length>128){h.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");return}if(g.goodsIntro.length>200){h.error("\u5546\u54C1\u7B80\u4ECB\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26");return}if(g.tag.length>16){h.error("\u5546\u54C1\u6807\u7B7E\u4E0D\u80FD\u8D85\u8FC716\u4E2A\u5B57\u7B26");return}console.log("params",g),f&&(g.goodsId=f,a=y.put),a("/good",g).then(()=>{h.success(f?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),j.push({path:"/good"})})}})},v=n=>{const a=n.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(a))return h.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},k=n=>{l.goodForm.goodsCoverImg=n.data||""},C=n=>{l.categoryId=n[1]||0},_=n=>{o.value.clearFiles(),l.goodForm.goodsCoverImg=""};return D(A({},Y(l)),{uploadRef:o,goodRef:i,submitAdd:c,handleBeforeUpload:v,handleUrlSuccess:k,editor:e,handleChangeCate:C,handleRemove:_})}},U=o=>(eo("data-v-5b264698"),o=o(),lo(),o),go=U(()=>m("label",{for:"runoob"},"Runoob",-1)),uo=U(()=>m("label",{for:"google"},"Google",-1)),mo=U(()=>m("label",{for:"taobao"},"taobao",-1)),po=P("\u4E0A\u67B6"),co=P("\u4E0B\u67B6"),fo=["src"],ho={class:"el-upload-list__item-actions"},vo={ref:"editor"};function _o(o,e,i,p,j,f){const l=u("el-form-item"),r=u("el-cascader"),c=u("el-input"),v=u("el-radio"),k=u("el-radio-group"),C=u("plus"),_=u("el-icon"),n=u("delete"),a=u("el-upload"),g=u("el-button"),I=u("el-form"),b=u("el-card");return E(),Z(b,null,{default:s(()=>[t(I,{model:o.goodForm,rules:o.rules,ref:"goodRef","label-width":"100px",class:"goodForm"},{default:s(()=>[t(l,{label:"\u590D\u9009\u6846"},{default:s(()=>[t(l,null,{default:s(()=>[S(" <p>\u591A\u4E2A\u590D\u9009\u6846\uFF1A</p> "),V(m("input",{type:"checkbox",id:"runoob",value:"1","onUpdate:modelValue":e[0]||(e[0]=d=>o.checkedNames=d)},null,512),[[w,o.checkedNames]]),go,V(m("input",{type:"checkbox",id:"google",value:"2","onUpdate:modelValue":e[1]||(e[1]=d=>o.checkedNames=d)},null,512),[[w,o.checkedNames]]),uo,V(m("input",{type:"checkbox",id:"taobao",value:"3","onUpdate:modelValue":e[2]||(e[2]=d=>o.checkedNames=d)},null,512),[[w,o.checkedNames]]),mo]),_:1})]),_:1}),t(l,{required:"",label:"\u5546\u54C1\u5206\u7C7B"},{default:s(()=>[t(r,{placeholder:o.defaultCate,style:{width:"300px"},props:o.category,onChange:p.handleChangeCate},null,8,["placeholder","props","onChange"])]),_:1}),t(l,{label:"\u5546\u54C1\u540D\u79F0",prop:"goodsName"},{default:s(()=>[t(c,{style:{width:"300px"},modelValue:o.goodForm.goodsName,"onUpdate:modelValue":e[3]||(e[3]=d=>o.goodForm.goodsName=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5546\u54C1\u7B80\u4ECB",prop:"goodsIntro"},{default:s(()=>[t(c,{style:{width:"300px"},type:"textarea",modelValue:o.goodForm.goodsIntro,"onUpdate:modelValue":e[4]||(e[4]=d=>o.goodForm.goodsIntro=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u7B80\u4ECB(100\u5B57)"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5546\u54C1\u4EF7\u683C",prop:"originalPrice"},{default:s(()=>[t(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.originalPrice,"onUpdate:modelValue":e[5]||(e[5]=d=>o.goodForm.originalPrice=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u4EF7\u683C"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5546\u54C1\u552E\u5356\u4EF7",prop:"sellingPrice"},{default:s(()=>[t(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.sellingPrice,"onUpdate:modelValue":e[6]||(e[6]=d=>o.goodForm.sellingPrice=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u552E\u4EF7"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5546\u54C1\u5E93\u5B58",prop:"stockNum"},{default:s(()=>[t(c,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.stockNum,"onUpdate:modelValue":e[7]||(e[7]=d=>o.goodForm.stockNum=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5E93\u5B58"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u5546\u54C1\u6807\u7B7E",prop:"tag"},{default:s(()=>[t(c,{style:{width:"300px"},modelValue:o.goodForm.tag,"onUpdate:modelValue":e[8]||(e[8]=d=>o.goodForm.tag=d),placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u5C0F\u6807\u7B7E"},null,8,["modelValue"])]),_:1}),t(l,{label:"\u4E0A\u67B6\u72B6\u6001",prop:"goodsSellStatus"},{default:s(()=>[t(k,{modelValue:o.goodForm.goodsSellStatus,"onUpdate:modelValue":e[9]||(e[9]=d=>o.goodForm.goodsSellStatus=d)},{default:s(()=>[t(v,{label:"0"},{default:s(()=>[po]),_:1}),t(v,{label:"1"},{default:s(()=>[co]),_:1})]),_:1},8,["modelValue"])]),_:1}),S(` 			<el-form-item required label="\u5546\u54C1\u4E3B\u56FE" prop="goodsCoverImg">\r
				<el-upload class="avatar-uploader" :action="uploadImgServer" accept="jpg,jpeg,png" :headers="{\r
              token: token\r
            }" :show-file-list="false" :before-upload="handleBeforeUpload" :on-success="handleUrlSuccess">\r
					<img style="width: 100px; height: 100px; border: 1px solid #e9e9e9;" v-if="goodForm.goodsCoverImg"\r
						:src="goodForm.goodsCoverImg" class="avatar">\r
					<el-icon v-else class="avatar-uploader-icon">\r
						<plus />\r
					</el-icon>\r
				</el-upload>\r
			</el-form-item> `),t(l,{label:"\u5546\u54C1\u4E3B\u56FE",prop:"goodsCoverImg"},{default:s(()=>[t(a,{ref:"uploadRef",action:o.uploadImgServer,limit:2,"list-type":"picture-card","thumbnail-mode":"true",headers:{token:o.token},"before-upload":p.handleBeforeUpload,"on-success":p.handleUrlSuccess,"auto-upload":!0,"file-list":o.goodForm.fileList},{default:s(()=>[t(_,null,{default:s(()=>[t(C)]),_:1})]),file:s(({file:d})=>[m("div",null,[m("img",{class:"el-upload-list__item-thumbnail",src:d.url,alt:""},null,8,fo),m("span",ho,[o.disabled?S("v-if",!0):(E(),$("span",{key:0,class:"el-upload-list__item-delete",onClick:e[10]||(e[10]=(...F)=>p.handleRemove&&p.handleRemove(...F))},[t(_,null,{default:s(()=>[t(n)]),_:1})]))])])]),_:1},8,["action","headers","before-upload","on-success","file-list"])]),_:1}),t(l,{label:"\u8BE6\u60C5\u5185\u5BB9"},{default:s(()=>[m("div",vo,null,512)]),_:1}),t(l,null,{default:s(()=>[t(g,{type:"primary",onClick:e[11]||(e[11]=d=>p.submitAdd())},{default:s(()=>[P(oo(o.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}var Fo=ao(io,[["render",_o],["__scopeId","data-v-5b264698"]]);export{Fo as default};
